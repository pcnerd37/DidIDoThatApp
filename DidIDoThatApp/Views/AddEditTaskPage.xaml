<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:DidIDoThatApp.ViewModels"
             xmlns:models="clr-namespace:DidIDoThatApp.Models"
             xmlns:enums="clr-namespace:DidIDoThatApp.Models.Enums"
             x:Class="DidIDoThatApp.Views.AddEditTaskPage"
             x:DataType="viewmodels:AddEditTaskViewModel"
             Title="{Binding Title}">

    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Save"
                     Command="{Binding SaveCommand}" />
    </ContentPage.ToolbarItems>

    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="16">

            <!-- Task Name -->
            <VerticalStackLayout Spacing="4">
                <Label Text="Task Name *"
                       FontAttributes="Bold" />
                <Entry Text="{Binding Name}"
                       Placeholder="e.g., Change oil"
                       MaxLength="200" />
            </VerticalStackLayout>

            <!-- Category Selection -->
            <VerticalStackLayout Spacing="4">
                <Label Text="Category *"
                       FontAttributes="Bold" />
                <Picker ItemsSource="{Binding Categories}"
                        SelectedItem="{Binding SelectedCategory}"
                        ItemDisplayBinding="{Binding Name}"
                        Title="Select a category" />
            </VerticalStackLayout>

            <!-- Description -->
            <VerticalStackLayout Spacing="4">
                <Label Text="Description"
                       FontAttributes="Bold" />
                <Editor Text="{Binding Description}"
                        Placeholder="Optional notes about this task..."
                        MaxLength="1000"
                        HeightRequest="100"
                        AutoSize="TextChanges" />
            </VerticalStackLayout>

            <!-- Frequency -->
            <Frame BackgroundColor="{AppThemeBinding Light=White, Dark={StaticResource Gray900}}"
                   Padding="16"
                   CornerRadius="8">
                <VerticalStackLayout Spacing="12">
                    <Label Text="Frequency"
                           FontSize="16"
                           FontAttributes="Bold" />
                    <Label Text="How often should this task be done?"
                           FontSize="12"
                           TextColor="{StaticResource Gray500}" />
                    
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
                        <VerticalStackLayout Spacing="4">
                            <Label Text="Every"
                                   FontSize="12"
                                   TextColor="{StaticResource Gray500}" />
                            <Entry Text="{Binding FrequencyValue}"
                                   Keyboard="Numeric"
                                   HorizontalTextAlignment="Center" />
                        </VerticalStackLayout>
                        
                        <VerticalStackLayout Grid.Column="1" Spacing="4">
                            <Label Text="Unit"
                                   FontSize="12"
                                   TextColor="{StaticResource Gray500}" />
                            <Picker ItemsSource="{Binding FrequencyUnits}"
                                    SelectedItem="{Binding FrequencyUnit}" />
                        </VerticalStackLayout>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- Reminder Toggle -->
            <Frame BackgroundColor="{AppThemeBinding Light=White, Dark={StaticResource Gray900}}"
                   Padding="16"
                   CornerRadius="8">
                <Grid ColumnDefinitions="*,Auto">
                    <VerticalStackLayout>
                        <Label Text="Enable Reminder"
                               FontSize="16"
                               FontAttributes="Bold" />
                        <Label Text="Get notified when this task is due"
                               FontSize="12"
                               TextColor="{StaticResource Gray500}" />
                    </VerticalStackLayout>
                    <Switch Grid.Column="1"
                            IsToggled="{Binding IsReminderEnabled}"
                            VerticalOptions="Center" />
                </Grid>
            </Frame>

            <!-- Action Buttons -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="12" Margin="0,16,0,0">
                <Button Text="Cancel"
                        Command="{Binding CancelCommand}"
                        BackgroundColor="{StaticResource Gray300}"
                        TextColor="{StaticResource Gray900}" />
                <Button Grid.Column="1"
                        Text="Save"
                        Command="{Binding SaveCommand}"
                        IsEnabled="{Binding CanSave}" />
            </Grid>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
